(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["piano/settings"],{"639d":function(t,e,n){"use strict";n("6a36")},"662a":function(t,e,n){},"6a36":function(t,e,n){},"9e78":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"piano-sts"},[e("div",{staticClass:"form-ct"},[e("div",{staticClass:"form"},[e("div",{staticClass:"sts-row"},[e("label",[t._v("隐藏顶部导航栏：")]),e("xwSwitch",{model:{value:t.state.hideNavBar,callback:function(e){t.$set(t.state,"hideNavBar",e)},expression:"state.hideNavBar"}})],1),e("div",{staticClass:"sts-row"},[e("label",[t._v("显示键盘上数字：")]),e("xwSwitch",{model:{value:t.state.cacheConf.showKbdNum,callback:function(e){t.$set(t.state.cacheConf,"showKbdNum",e)},expression:"state.cacheConf.showKbdNum"}})],1),e("div",{staticClass:"sts-row"},[e("label",[t._v("放大和缩小键盘：")]),e("xw-button",{attrs:{type:"primary"},on:{click:function(e){return t.scaleCG(-1)}}},[t._v("缩小")]),e("b",{staticClass:"scaletext"},[t._v(t._s(t.state.cacheConf.scale))]),e("xw-button",{attrs:{type:"primary"},on:{click:function(e){return t.scaleCG(1)}}},[t._v("放大")])],1),e("div",{staticClass:"sts-row"},[e("label",[t._v("外接MIDI键盘：")]),e("settings-midi-peripheral")],1)])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.state.cacheConf.barScale<1,expression:"state.cacheConf.barScale < 1"}],staticClass:"btm-fixed"},[e("div",{staticClass:"visible-line"},[e("div",{staticClass:"visible-bar",style:{width:"".concat(100*t.state.cacheConf.barScale,"%"),left:"".concat((1-t.state.cacheConf.barScale)*t.state.cacheConf.left*100,"%")}})]),e("div",{staticClass:"xw-btn f-btn lef",on:{click:function(e){return t.mleft(!1)}}},[t._v("左")]),e("div",{staticClass:"xw-btn f-btn rit",on:{click:function(e){return t.mleft(!0)}}},[t._v("右")])])])},i=[],a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"xw-switch",class:t.value?"on-state":"",on:{click:t.trigger}},[e("div",{staticClass:"bar"})])},c=[],o={model:{prop:"value",event:"change"},props:{value:Boolean},data:function(){return{}},methods:{trigger:function(){this.$emit("change",!this.value)}}},r=o,u=(n("639d"),n("2877")),l=Object(u["a"])(r,a,c,!1,null,null,null),f=l.exports,d=n("8dfd"),h=n("2c69"),v=(n("b0c0"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"midi-access"},[t.support?e("div",{staticClass:"support"},[e("xw-button",{on:{click:function(e){return t.doConnect()}}},[t._v(t._s(t.linked?"刷新":"立即连接"))]),t.linked?e("xw-button",{on:{click:function(e){return t.doDisconnect()}}},[t._v("断开")]):t._e(),t.linked?t._e():e("span",{staticClass:"tips"},[t._v("可将midi键盘或者电钢琴通过USB连接到您的电脑或手机后点击左侧连接按钮")]),t.errMsg?e("span",{staticClass:"tips error"},[t._v(t._s(t.errMsg))]):t._e(),t.deviceInfo.length>=0?e("div",{staticClass:"d-info"},t._l(t.deviceInfo,(function(n){return e("div",{key:n.id,staticClass:"d-info-item"},[t._v(" 已连接： "+t._s(n.manufacturer)+" "+t._s(n.name)+" ")])})),0):t._e(),0==t.deviceInfo.length&&t.linked?e("div",{staticClass:"d-info"},[t._v("未检测到设备")]):t._e()],1):e("div",{staticClass:"not-support"},[t._v(" 检测到您的浏览器不支持该功能。此功能可在电脑上的Chorme浏览器，大于5.0版本的安卓手机上运行。苹果移动设备上兼容性未知。 ")])])}),p=[],b=(n("14d9"),n("e9f5"),n("7d54"),n("d3b7"),n("159b"),n("d4ec")),m=n("bee2"),C=(n("d9e2"),n("ddb0"),n("5f04")),w=n("166b");function _(){return!w["a"].isServer&&!!navigator.requestMIDIAccess}function k(t){if(144===t.data[0]){var e=t.data[1],n=t.data[2];n>0?C["a"].down([e-20],!1,3):C["a"].up([e-20],3)}}var x=function(){function t(e){Object(b["a"])(this,t),this.midiAccess=e,this.enable=!0;var n=e.inputs,s=n.values();this.inputs=[],this.setMidiInputs(s)}return Object(m["a"])(t,[{key:"setMidiInputs",value:function(t){for(var e=this,n=t.next();n&&!n.done;n=t.next())n.value.onmidimessage=function(t){e.midiMessage(t)},this.inputs.push(n.value)}},{key:"midiMessage",value:function(t){this.enable&&k(t)}},{key:"destory",value:function(){this.enable=!1,this.inputs.forEach((function(t){t.onmidimessage=null}))}}])}(),g=null;function I(){return g}function y(){return new Promise((function(t,e){navigator.requestMIDIAccess().then((function(e){g&&g.destory(),g=new x(e),t()}),(function(){e(new Error("No access to your midi devices."))}))}))}function M(){g&&g.destory(),g=null}var N={components:{xwButton:h["a"]},data:function(){return{support:!1,linked:!1,deviceInfo:[],errMsg:""}},mounted:function(){this.support=_(),this.refreshInfo()},methods:{doConnect:function(){var t=this;y().then((function(){t.refreshInfo()})).catch((function(e){t.errMsg="".concat(e)}))},doDisconnect:function(){M(),this.refreshInfo()},refreshInfo:function(){var t=I();if(t){this.linked=!0;var e=[];t.inputs.forEach((function(t){e.push({id:t.id,name:t.name,manufacturer:t.manufacturer})})),this.deviceInfo=e}else this.linked=!1,this.deviceInfo=[]}}},S=N,B=(n("e284"),Object(u["a"])(S,v,p,!1,null,null,null)),j=B.exports,O={components:{xwSwitch:f,xwButton:h["a"],settingsMidiPeripheral:j},data:function(){return{}},computed:{state:function(){return this.$store.state}},watch:{"state.hideNavBar":function(){this.$nextTick(d["a"])},"state.cacheConf.showKbdNum":function(){}},mounted:function(){},methods:{scaleCG:function(t){var e=this.state.cacheConf.scale;e+=t,e<1?e=1:e>20&&(e=20),this.state.cacheConf.scale=e,this.$nextTick(d["a"])},mleft:function(t){var e=this.state.cacheConf.left;t?e+=.1:e-=.1,e<0?e=0:e>1&&(e=1),this.state.cacheConf.left=e,Object(d["a"])()}}},$=O,D=(n("ce1d"),Object(u["a"])($,s,i,!1,null,null,null));e["default"]=D.exports},bef5:function(t,e,n){},ce1d:function(t,e,n){"use strict";n("662a")},e284:function(t,e,n){"use strict";n("bef5")}}]);
//# sourceMappingURL=settings.3949d1ad.js.map